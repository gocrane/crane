<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.102.3"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Resource Recommendation | Crane</title><meta name=description content="Introduce for Resource Recommendation"><meta property="og:title" content="Resource Recommendation"><meta property="og:description" content="Introduce for Resource Recommendation"><meta property="og:type" content="article"><meta property="og:url" content="/docs/tutorials/recommendation/resource-recommendation/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-03-15T04:27:07-05:00"><meta property="og:site_name" content="Crane"><meta itemprop=name content="Resource Recommendation"><meta itemprop=description content="Introduce for Resource Recommendation"><meta itemprop=dateModified content="2024-03-15T04:27:07-05:00"><meta itemprop=wordCount content="1167"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Resource Recommendation"><meta name=twitter:description content="Introduce for Resource Recommendation"><link rel=preload href=/scss/main.min.730362c672539a20af5e07f8cb554bed1d08f06cf874786f2cba9f08a6a884cb.css as=style><link href=/scss/main.min.730362c672539a20af5e07f8cb554bed1d08f06cf874786f2cba9f08a6a884cb.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="306" height="186" viewBox="144.139 425.446 306 186" enable-background="new 144.139 425.446 306 186"><path fill="#58bda6" d="M267.919 572.702c-.372 5.728-4.972 10.091-10.27 9.743l-40.779-2.65c-5.3-.347-9.293-5.269-8.923-10.991l2.974-45.702c.373-5.728 4.973-10.088 10.271-9.743l40.78 2.652c5.299.345 9.293 5.267 8.921 10.99L267.919 572.702z"/><path fill="#ee7300" d="M355.802 528.969c-28.058-24.713-63.021-62.657-91.196-87.232-1.938-1.69-5.604-3.409-7.457-2.647-1.938.795-3.404 4.46-3.778 7.058-1.761 12.192-2.91 28.237-4.656 40.433-.437 3.041-1.971 6.067-3.571 8.762-2.041 3.435-.873 12.792 2.958 15.723 3.085 2.357 4.303 5.096 1.854 7.834-1.351 1.512-4.525 1.391-6.992 2.032 2.374 2.482 5.765 2.633 9.24-.084 3.808-2.979 2.631-7.084-4.054-14.46 4.628-3.659 5.886-7.839 2.424-13.33-1.104-1.75-.191-4.886.068-7.356 1.027-9.761 2.094-23.278 3.315-33.019.292-2.324 1.237-4.564 2.349-8.479 26.078 34.224 56.794 78.868 82.623 112.767.93-6.764-.387-17.9-.708-23.131-.193-3.154-5.785-8.536-7.861-11.352-3.039-4.109-6.746-7.742-9.644-11.94-.76-1.101-.824-2.206.128-3.594 1.252-1.816 2.925.178 3.865 1.018 9.287 8.277 25.465 24.596 31.02 35.665.248.495-1.506-11.808-.865-10.746"/><path d="M185.44 554.611v-4.04c0-2.692-.57-4.727-1.712-6.104-1.145-1.375-2.634-2.062-4.475-2.062-3.021-.056-5.026.505-6.021 1.686-.994 1.179-1.49 2.806-1.49 4.881l-.11 31.229c0 1.796.515 3.188 1.548 4.166 1.028.982 2.834 1.476 5.412 1.476 1.618.0 2.908-.295 3.866-.883.957-.593 1.692-1.334 2.21-2.231.515-.896.828-1.88.938-2.946.11-1.064.166-2.076.166-3.028v-5.726h19.442v7.744c0 2.693-.534 5.176-1.603 7.449-1.067 2.271-2.727 4.224-4.972 5.85-2.247 1.629-5.156 2.894-8.729 3.788-3.573.897-7.826 1.347-12.761 1.347-4.493.0-8.305-.447-11.435-1.347-3.132-.896-5.688-2.201-7.679-3.914-1.988-1.71-3.442-3.813-4.363-6.312-.922-2.497-1.382-5.349-1.382-8.545V551.16c0-6.899 2.117-11.979 6.354-15.233 4.232-3.254 10.808-4.883 19.72-4.883 4.124.0 7.823.353 11.104 1.054 3.275.702 6.058 1.782 8.341 3.239 2.282 1.461 4.033 3.354 5.248 5.684s1.821 5.092 1.821 8.29v5.304H185.44V554.611z"/><path fill="#fff" d="M231.8 574.649l-16.795-1.156 3.754-54.526 24.521 1.688c6.934.479 12.024 1.985 15.27 4.521 3.243 2.536 4.682 6.521 4.308 11.945-.2 2.909-.979 5.362-2.329 7.364-1.354 2.001-3.818 3.488-7.4 4.457l-.009.146c2.324.553 4.212 1.483 5.653 2.801 1.443 1.316 2.162 2.924 2.161 4.824.049 1.125.066 2.486.052 4.094-.013 1.604-.028 3.235-.047 4.892-.019 1.655-.018 3.236.007 4.749.023 1.514.135 2.712.329 3.603.389.854.887 1.521 1.49 2.002l-.051.729-18.317-1.261c-.219-.552-.392-1.086-.515-1.608-.125-.518-.199-1.046-.228-1.586.039-2.43.165-4.724.379-6.877.211-2.148.247-4.084.11-5.799-.139-1.712-.569-3.105-1.294-4.18-.726-1.074-2.071-1.726-4.036-1.958l-5.533-.381L231.8 574.649zM233.957 543.314l5.726.396c1.208.081 2.222-.041 3.045-.375.821-.334 1.479-.801 1.966-1.399s.842-1.305 1.058-2.118c.216-.812.354-1.631.409-2.455.108-1.6-.026-2.875-.409-3.827-.38-.949-1.034-1.679-1.958-2.18-.923-.501-2.132-.842-3.62-1.017-1.49-.177-3.255-.311-5.294-.401L233.957 543.314z"/><path d="M265.164 595.689l18.116-63.132h23.423l18.006 63.132h-19.663l-2.762-12.291h-15.246l-2.318 12.291H265.164zm29.828-51.684h-.222l-5.634 28.282h11.269L294.992 544.005z"/><path d="M352.709 556.745l-.223.168 1.77 35.188h-18.448v-63.132h19.995l15.024 35.269h.331l-1.88-35.269h18.45V592.1h-19.887l-15.132-35.355z"/><path d="M397.406 595.689v-63.132h44.521v12.625H416.85V556.8h24.305v12.627H416.85v13.636h26.403v12.627L397.406 595.689z"/><circle fill="#fff" cx="344.901" cy="536.967" r="3.136"/></svg></span><span class=font-weight-bold>Crane</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><i class='fas fa-book pr-2'></i><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><i class='fas fa-rss pr-2'></i><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><i class='fab fa-youtube pr-2'></i><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/gocrane/crane target=_blank><i class='fab fa-github pr-2'></i><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=http://dashboard.gocrane.io/ target=_blank><i class='fa-regular fa-flag'></i><span>Live Demo</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Crane Blog</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://gocrane.io>main</a></div></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh-cn/docs/tutorials/recommendation/resource-recommendation/>Chinese</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh-cn/docs/tutorials/recommendation/resource-recommendation/>Chinese</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgetting-started-li><input type=checkbox id=m-docsgetting-started-check>
<label for=m-docsgetting-started-check><a href=/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgetting-started><span>Getting Started</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgetting-startedintroduction-li><input type=checkbox id=m-docsgetting-startedintroduction-check>
<label for=m-docsgetting-startedintroduction-check><a href=/docs/getting-started/introduction/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgetting-startedintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgetting-startedinstallation-li><input type=checkbox id=m-docsgetting-startedinstallation-check>
<label for=m-docsgetting-startedinstallation-check><a href=/docs/getting-started/installation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgetting-startedinstallation><span>Installation</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgetting-startedinstallationquick-start-li><input type=checkbox id=m-docsgetting-startedinstallationquick-start-check>
<label for=m-docsgetting-startedinstallationquick-start-check><a href=/docs/getting-started/installation/quick-start/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgetting-startedinstallationquick-start><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgetting-startedinstallationinstallation-li><input type=checkbox id=m-docsgetting-startedinstallationinstallation-check>
<label for=m-docsgetting-startedinstallationinstallation-check><a href=/docs/getting-started/installation/installation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgetting-startedinstallationinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgetting-startedinstallationinstallation-cli-tool-li><input type=checkbox id=m-docsgetting-startedinstallationinstallation-cli-tool-check>
<label for=m-docsgetting-startedinstallationinstallation-cli-tool-check><a href=/docs/getting-started/installation/installation-cli-tool/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgetting-startedinstallationinstallation-cli-tool><span>Installation of CLI Tool</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docscore-concept-li><input type=checkbox id=m-docscore-concept-check>
<label for=m-docscore-concept-check><a href=/docs/core-concept/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docscore-concept><span>Core Concept</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscore-conceptresource-optimize-model-li><input type=checkbox id=m-docscore-conceptresource-optimize-model-check>
<label for=m-docscore-conceptresource-optimize-model-check><a href=/docs/core-concept/resource-optimize-model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscore-conceptresource-optimize-model><span>Application Resource Optimize Model</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscore-concepttimeseries-forecasting-by-dsp-li><input type=checkbox id=m-docscore-concepttimeseries-forecasting-by-dsp-check>
<label for=m-docscore-concepttimeseries-forecasting-by-dsp-check><a href=/docs/core-concept/timeseries-forecasting-by-dsp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscore-concepttimeseries-forecasting-by-dsp><span>Time Series Forecast Algorithm-DSP</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscore-conceptarchitecture-li><input type=checkbox id=m-docscore-conceptarchitecture-check>
<label for=m-docscore-conceptarchitecture-check><a href=/docs/core-concept/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscore-conceptarchitecture><span>Architecture</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docstutorials-li><input type=checkbox id=m-docstutorials-check checked>
<label for=m-docstutorials-check><a href=/docs/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docstutorials><span>Tutorials</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docstutorialscolocation-with-enhanced-qos-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qos-check>
<label for=m-docstutorialscolocation-with-enhanced-qos-check><a href=/docs/tutorials/colocation-with-enhanced-qos/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docstutorialscolocation-with-enhanced-qos><span>Colocation with Enhanced QOS</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosusing-qos-ensurance-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosusing-qos-ensurance-check>
<label for=m-docstutorialscolocation-with-enhanced-qosusing-qos-ensurance-check><a href=/docs/tutorials/colocation-with-enhanced-qos/using-qos-ensurance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosusing-qos-ensurance><span>Colocation with Enhanced QOS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosqos-interference-detection-and-active-avoidance-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosqos-interference-detection-and-active-avoidance-check>
<label for=m-docstutorialscolocation-with-enhanced-qosqos-interference-detection-and-active-avoidance-check><a href=/docs/tutorials/colocation-with-enhanced-qos/qos-interference-detection-and-active-avoidance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosqos-interference-detection-and-active-avoidance><span>Interference Detection and Active Avoidance</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosqos-dynamic-resource-oversold-and-limit-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosqos-dynamic-resource-oversold-and-limit-check>
<label for=m-docstutorialscolocation-with-enhanced-qosqos-dynamic-resource-oversold-and-limit-check><a href=/docs/tutorials/colocation-with-enhanced-qos/qos-dynamic-resource-oversold-and-limit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosqos-dynamic-resource-oversold-and-limit><span>Dynamic resource oversold and limit</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosqos-accurately-perform-avoidance-actions-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosqos-accurately-perform-avoidance-actions-check>
<label for=m-docstutorialscolocation-with-enhanced-qosqos-accurately-perform-avoidance-actions-check><a href=/docs/tutorials/colocation-with-enhanced-qos/qos-accurately-perform-avoidance-actions/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosqos-accurately-perform-avoidance-actions><span>Accurately Perform Avoidance Actions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosqos-customized-metrics-interference-detection-avoidance-and-sorting-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosqos-customized-metrics-interference-detection-avoidance-and-sorting-check>
<label for=m-docstutorialscolocation-with-enhanced-qosqos-customized-metrics-interference-detection-avoidance-and-sorting-check><a href=/docs/tutorials/colocation-with-enhanced-qos/qos-customized-metrics-interference-detection-avoidance-and-sorting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosqos-customized-metrics-interference-detection-avoidance-and-sorting><span>Define your watermark</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialscolocation-with-enhanced-qosqos-enhanced-bypass-cpuset-management-li><input type=checkbox id=m-docstutorialscolocation-with-enhanced-qosqos-enhanced-bypass-cpuset-management-check>
<label for=m-docstutorialscolocation-with-enhanced-qosqos-enhanced-bypass-cpuset-management-check><a href=/docs/tutorials/colocation-with-enhanced-qos/qos-enhanced-bypass-cpuset-management/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialscolocation-with-enhanced-qosqos-enhanced-bypass-cpuset-management><span>Enhanced bypass cpuset management capability</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docstutorialsrecommendation-li><input type=checkbox id=m-docstutorialsrecommendation-check checked>
<label for=m-docstutorialsrecommendation-check><a href=/docs/tutorials/recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docstutorialsrecommendation><span>Recommendation</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationrecommendation-framework-li><input type=checkbox id=m-docstutorialsrecommendationrecommendation-framework-check>
<label for=m-docstutorialsrecommendationrecommendation-framework-check><a href=/docs/tutorials/recommendation/recommendation-framework/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationrecommendation-framework><span>Recommendation Framework</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationreplicas-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationreplicas-recommendation-check>
<label for=m-docstutorialsrecommendationreplicas-recommendation-check><a href=/docs/tutorials/recommendation/replicas-recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationreplicas-recommendation><span>Replicas Recommendation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationresource-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationresource-recommendation-check>
<label for=m-docstutorialsrecommendationresource-recommendation-check><a href=/docs/tutorials/recommendation/resource-recommendation/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationresource-recommendation><span class=td-sidebar-nav-active-item>Resource Recommendation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationidlenode-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationidlenode-recommendation-check>
<label for=m-docstutorialsrecommendationidlenode-recommendation-check><a href=/docs/tutorials/recommendation/idlenode-recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationidlenode-recommendation><span>IdleNode Recommendation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationhpa-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationhpa-recommendation-check>
<label for=m-docstutorialsrecommendationhpa-recommendation-check><a href=/docs/tutorials/recommendation/hpa-recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationhpa-recommendation><span>HPA Recommendation（Alpha）</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationservice-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationservice-recommendation-check>
<label for=m-docstutorialsrecommendationservice-recommendation-check><a href=/docs/tutorials/recommendation/service-recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationservice-recommendation><span>Service Recommendation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationpv-recommendation-li><input type=checkbox id=m-docstutorialsrecommendationpv-recommendation-check>
<label for=m-docstutorialsrecommendationpv-recommendation-check><a href=/docs/tutorials/recommendation/pv-recommendation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationpv-recommendation><span>PV Recommendation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsrecommendationhow-to-develop-recommender-li><input type=checkbox id=m-docstutorialsrecommendationhow-to-develop-recommender-check>
<label for=m-docstutorialsrecommendationhow-to-develop-recommender-check><a href=/docs/tutorials/recommendation/how-to-develop-recommender/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsrecommendationhow-to-develop-recommender><span>How to develop Recommender</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsdynamic-scheduler-plugin-li><input type=checkbox id=m-docstutorialsdynamic-scheduler-plugin-check>
<label for=m-docstutorialsdynamic-scheduler-plugin-check><a href=/docs/tutorials/dynamic-scheduler-plugin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsdynamic-scheduler-plugin><span>Dynamic-scheduler: a load-aware scheduler plugin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsscheduling-pods-based-on-actual-node-load-li><input type=checkbox id=m-docstutorialsscheduling-pods-based-on-actual-node-load-check>
<label for=m-docstutorialsscheduling-pods-based-on-actual-node-load-check><a href=/docs/tutorials/scheduling-pods-based-on-actual-node-load/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsscheduling-pods-based-on-actual-node-load><span>Crane-scheduler</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsusing-effective-hpa-to-scaling-with-effectiveness-li><input type=checkbox id=m-docstutorialsusing-effective-hpa-to-scaling-with-effectiveness-check>
<label for=m-docstutorialsusing-effective-hpa-to-scaling-with-effectiveness-check><a href=/docs/tutorials/using-effective-hpa-to-scaling-with-effectiveness/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsusing-effective-hpa-to-scaling-with-effectiveness><span>Effective HorizontalPodAutoscaler</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docstutorialsusing-time-series-prediction-li><input type=checkbox id=m-docstutorialsusing-time-series-prediction-check>
<label for=m-docstutorialsusing-time-series-prediction-check><a href=/docs/tutorials/using-time-series-prediction/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docstutorialsusing-time-series-prediction><span>TimeSeriesPrediction</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsbest-practices-li><input type=checkbox id=m-docsbest-practices-check>
<label for=m-docsbest-practices-check><a href=/docs/best-practices/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsbest-practices><span>Best Practices</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsbest-practiceseffective-hpa-with-prometheus-adapter-li><input type=checkbox id=m-docsbest-practiceseffective-hpa-with-prometheus-adapter-check>
<label for=m-docsbest-practiceseffective-hpa-with-prometheus-adapter-check><a href=/docs/best-practices/effective-hpa-with-prometheus-adapter/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbest-practiceseffective-hpa-with-prometheus-adapter><span>Intelligent Autoscaling Practices Based on Effective HPA for Custom Metrics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsbest-practiceshow-to-optimize-your-application-resource-li><input type=checkbox id=m-docsbest-practiceshow-to-optimize-your-application-resource-check>
<label for=m-docsbest-practiceshow-to-optimize-your-application-resource-check><a href=/docs/best-practices/how-to-optimize-your-application-resource/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbest-practiceshow-to-optimize-your-application-resource><span>How to optimize your application in FinOps era</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsbest-practiceshow-kujiale-adopt-ehpa-li><input type=checkbox id=m-docsbest-practiceshow-kujiale-adopt-ehpa-check>
<label for=m-docsbest-practiceshow-kujiale-adopt-ehpa-check><a href=/docs/best-practices/how-kujiale-adopt-ehpa/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbest-practiceshow-kujiale-adopt-ehpa><span>How Kujiale achieve autoscaling with Crane EHPA</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsproposals-li><input type=checkbox id=m-docsproposals-check>
<label for=m-docsproposals-check><a href=/docs/proposals/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsproposals><span>Proposals</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsproposals20220228-advanced-cpuset-manger-li><input type=checkbox id=m-docsproposals20220228-advanced-cpuset-manger-check>
<label for=m-docsproposals20220228-advanced-cpuset-manger-check><a href=/docs/proposals/20220228-advanced-cpuset-manger/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsproposals20220228-advanced-cpuset-manger><span>Advanced CPUSet Manager</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsproposals20220402-policy-based-abnomal-detection-li><input type=checkbox id=m-docsproposals20220402-policy-based-abnomal-detection-check>
<label for=m-docsproposals20220402-policy-based-abnomal-detection-check><a href=/docs/proposals/20220402-policy-based-abnomal-detection/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsproposals20220402-policy-based-abnomal-detection><span>Provide a policy-based abnormal detection mechanism in crane-agent</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsproposals20220706-recommendation-framework-li><input type=checkbox id=m-docsproposals20220706-recommendation-framework-check>
<label for=m-docsproposals20220706-recommendation-framework-check><a href=/docs/proposals/20220706-recommendation-framework/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsproposals20220706-recommendation-framework><span>Recommendation Framework</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsproposalspod-sorting-and-precise-execution-for-crane-agent-li><input type=checkbox id=m-docsproposalspod-sorting-and-precise-execution-for-crane-agent-check>
<label for=m-docsproposalspod-sorting-and-precise-execution-for-crane-agent-check><a href=/docs/proposals/pod-sorting-and-precise-execution-for-crane-agent/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsproposalspod-sorting-and-precise-execution-for-crane-agent><span>Pod Sorting And Precise Execution For Crane Agent</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docscontributing-li><input type=checkbox id=m-docscontributing-check>
<label for=m-docscontributing-check><a href=/docs/contributing/ title=Contributing class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docscontributing><span>Contributing Guidelines</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontributingcontributing-li><input type=checkbox id=m-docscontributingcontributing-check>
<label for=m-docscontributingcontributing-check><a href=/docs/contributing/contributing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscontributingcontributing><span>Contributing to Crane</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontributingdeveloper-guide-li><input type=checkbox id=m-docscontributingdeveloper-guide-check>
<label for=m-docscontributingdeveloper-guide-check><a href=/docs/contributing/developer-guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscontributingdeveloper-guide><span>Developer Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontributingcode-standards-li><input type=checkbox id=m-docscontributingcode-standards-check>
<label for=m-docscontributingcode-standards-check><a href=/docs/contributing/code-standards/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscontributingcode-standards><span>Code Standard</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsroadmap-li><input type=checkbox id=m-docsroadmap-check>
<label for=m-docsroadmap-check><a href=/docs/roadmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsroadmap><span>Roadmap</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsroadmaproadmap-2023-li><input type=checkbox id=m-docsroadmaproadmap-2023-check>
<label for=m-docsroadmaproadmap-2023-check><a href=/docs/roadmap/roadmap-2023/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsroadmaproadmap-2023><span>Roadmap for 2023</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsroadmaproadmap-2022-li><input type=checkbox id=m-docsroadmaproadmap-2022-check>
<label for=m-docsroadmaproadmap-2022-check><a href=/docs/roadmap/roadmap-2022/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsroadmaproadmap-2022><span>Roadmap for 2022</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsmirror-resources-li><input type=checkbox id=m-docsmirror-resources-check>
<label for=m-docsmirror-resources-check><a href=/docs/mirror-resources/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsmirror-resources><span>Mirror Resources</span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#motivation>Motivation</a></li><li><a href=#sample>Sample</a></li><li><a href=#implement>Implement</a><ul><li><a href=#vpa-algorithm>VPA Algorithm</a></li><li><a href=#oom-protection>OOM Protection</a></li><li><a href=#resource-specification>Resource Specification</a></li><li><a href=#prometheus-metric>Prometheus Metric</a></li></ul></li><li><a href=#how-to-verify-the-accuracy-of-recommendation-results>How to verify the accuracy of recommendation results</a></li><li><a href=#accepted-resources>Accepted Resources</a></li><li><a href=#configuration>Configuration</a></li><li><a href=#default-resource-specifications-configuration>Default resource specifications configuration</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Documentation</a></li><li class=breadcrumb-item><a href=/docs/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=/docs/tutorials/recommendation/>Recommendation</a></li><li class="breadcrumb-item active" aria-current=page><a href=/docs/tutorials/recommendation/resource-recommendation/>Resource Recommendation</a></li></ol></nav><div class=td-content><h1>Resource Recommendation</h1><div class=lead>Introduce for Resource Recommendation</div><header class=article-meta><p class=reading-time><i class="fa fa-clock" aria-hidden=true></i>&nbsp; 6 minute read &nbsp;</p></header><p>Kubernetes&rsquo; users often config request and limit based on empirical values when creating application resources. Based on the resource recommendation algorithm, you can analyze the actual application usage and recommend more appropriate resource configurations. You can use the resource recommendation algorithm to improve the resource utilization of the cluster.</p><h2 id=motivation>Motivation</h2><p>In Kubernetes, Request defines the minimum amount of resources required by Pod, Limit defines the maximum amount of resources capability for Pod , and workload&rsquo;s Utilization = Resource Usage / Request. There are two types of unreasonable resource utilization:</p><ul><li>Utilization too low: The Request is often set to a large value because user don&rsquo;t know how many resource specifications can meet application requirements and choose to make it higher. It leads to a lot of resource waste.</li><li>Utilization too high: Due to the service pressure caused by peak traffic or incorrect resource configuration. If the CPU usage is too high, it might cause more delay. If the memory usage exceeds the Limit, the Container will be killed, which affects service stability.</li></ul><p>The figure below shows a workload with low utilization, it has 30% of the resource wasted between the Pod&rsquo;s peak historical usage and its Request.</p><p><img src=/images/resource-waste.jpg alt="Resource Waste"></p><p>Resource recommendation attempts to reduce the complexity of how to know the fit request of workloads by analyzing the historical usage.</p><h2 id=sample>Sample</h2><p>A Resource recommendation sample yaml looks like below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Recommendation</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>analysis.crane.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>workloads-rule-resource-flzbv</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>crane-system</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-rule-name</span>: <span style=color:#ae81ff>workloads-rule</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-rule-recommender</span>: <span style=color:#ae81ff>Resource</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-rule-uid</span>: <span style=color:#ae81ff>18588495</span>-<span style=color:#ae81ff>f325-4873-b45a-7acfe9f1ba94</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-target-kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-target-name</span>: <span style=color:#ae81ff>load-test</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>analysis.crane.io/recommendation-target-version</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>craned</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/instance</span>: <span style=color:#ae81ff>crane</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/managed-by</span>: <span style=color:#ae81ff>Helm</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/name</span>: <span style=color:#ae81ff>crane</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>app.kubernetes.io/version</span>: <span style=color:#ae81ff>v0.7.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>helm.sh/chart</span>: <span style=color:#ae81ff>crane-0.7.0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ownerReferences</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>analysis.crane.io/v1alpha1</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>RecommendationRule</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>workloads-rule</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>uid</span>: <span style=color:#ae81ff>18588495</span>-<span style=color:#ae81ff>f325-4873-b45a-7acfe9f1ba94</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>controller</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>blockOwnerDeletion</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>targetRef</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>crane-system</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>craned</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>Resource</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>completionStrategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>completionStrategyType</span>: <span style=color:#ae81ff>Once</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>adoptionType</span>: <span style=color:#ae81ff>StatusAndAnnotation</span>
</span></span><span style=display:flex><span><span style=color:#f92672>status</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>recommendedValue</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>resourceRequest</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>containerName</span>: <span style=color:#ae81ff>craned</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>target</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>150m</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>256Mi</span>
</span></span><span style=display:flex><span>        - <span style=color:#f92672>containerName</span>: <span style=color:#ae81ff>dashboard</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>target</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>150m</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>256Mi</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>targetRef</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>recommendedInfo</span>: &gt;-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    </span>    {<span style=color:#e6db74>&#34;spec&#34;</span>:{<span style=color:#e6db74>&#34;template&#34;</span>:{<span style=color:#e6db74>&#34;spec&#34;</span>:{<span style=color:#e6db74>&#34;containers&#34;</span>:[{<span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;craned&#34;</span>,<span style=color:#e6db74>&#34;resources&#34;</span>:{<span style=color:#e6db74>&#34;requests&#34;</span>:{<span style=color:#e6db74>&#34;cpu&#34;</span>:<span style=color:#e6db74>&#34;150m&#34;</span>,<span style=color:#e6db74>&#34;memory&#34;</span>:<span style=color:#e6db74>&#34;256Mi&#34;</span>}}},{<span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;dashboard&#34;</span>,<span style=color:#e6db74>&#34;resources&#34;</span>:{<span style=color:#e6db74>&#34;requests&#34;</span>:{<span style=color:#e6db74>&#34;cpu&#34;</span>:<span style=color:#e6db74>&#34;150m&#34;</span>,<span style=color:#e6db74>&#34;memory&#34;</span>:<span style=color:#e6db74>&#34;256Mi&#34;</span>}}}]}}}}
</span></span><span style=display:flex><span>  <span style=color:#f92672>currentInfo</span>: &gt;-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    </span>    {<span style=color:#e6db74>&#34;spec&#34;</span>:{<span style=color:#e6db74>&#34;template&#34;</span>:{<span style=color:#e6db74>&#34;spec&#34;</span>:{<span style=color:#e6db74>&#34;containers&#34;</span>:[{<span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;craned&#34;</span>,<span style=color:#e6db74>&#34;resources&#34;</span>:{<span style=color:#e6db74>&#34;requests&#34;</span>:{<span style=color:#e6db74>&#34;cpu&#34;</span>:<span style=color:#e6db74>&#34;500m&#34;</span>,<span style=color:#e6db74>&#34;memory&#34;</span>:<span style=color:#e6db74>&#34;512Mi&#34;</span>}}},{<span style=color:#e6db74>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;dashboard&#34;</span>,<span style=color:#e6db74>&#34;resources&#34;</span>:{<span style=color:#e6db74>&#34;requests&#34;</span>:{<span style=color:#e6db74>&#34;cpu&#34;</span>:<span style=color:#e6db74>&#34;200m&#34;</span>,<span style=color:#e6db74>&#34;memory&#34;</span>:<span style=color:#e6db74>&#34;256Mi&#34;</span>}}}]}}}}
</span></span><span style=display:flex><span>  <span style=color:#f92672>action</span>: <span style=color:#ae81ff>Patch</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>conditions</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>type</span>: <span style=color:#ae81ff>Ready</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>status</span>: <span style=color:#e6db74>&#39;True&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>lastTransitionTime</span>: <span style=color:#e6db74>&#39;2022-11-29T04:07:44Z&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>reason</span>: <span style=color:#ae81ff>RecommendationReady</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Recommendation is ready</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>lastUpdateTime</span>: <span style=color:#e6db74>&#39;2022-11-30T03:07:49Z&#39;</span>
</span></span></code></pre></div><p>In this sample：</p><ul><li>Recommendation TargetRef point to a Deployment in namespace crane-system：craned</li><li>Recommendation type is Replicas</li><li>adoptionType is StatusAndAnnotation，indicated that put recommendation result in recommendation.status and Deployment 的 Annotation</li><li>recommendedInfo shows the recommended requests for containers（recommendedValue is deprecated），currentInfo shows the current request for containers. The format is Json that can be updated for TargetRef by <code>Kubectl Patch</code></li></ul><p>How to create a Resource recommendation please refer to：<a href=/docs/tutorials/recommendation/recommendation-framework><strong>Recommendation Framework</strong></a></p><h2 id=implement>Implement</h2><p>The process for one Resource recommendation:</p><ol><li>Query the historical CPU and Memory usage of the Workload for the past week by monitoring system.</li><li>Take the P99 percentile usage through VPA Histogram, and then multiply the amplification factor</li><li>OOM protection: If the container has a history of OOM events, it is recommended to increase the memory size based on the memory used when OOM happened.</li><li>Resource specifications: The recommended result is rounded up based on the specified pod specifications</li></ol><p>To sum up, based on the historical resource usage, set the Request value to slightly higher than the historical maximum and consider the OOM and Pod specifications.</p><h3 id=vpa-algorithm>VPA Algorithm</h3><p>The core algorithm of resource recommendation is to recommend reasonable resource request based on historical resource consumption. we adopt the community VPA Histogram algorithm to implement it. VPA algorithm puts the historical resource consumption into the histogram, finds the P99 percentage of resource consumption, and multiplies the percentage by the amplification factor as the recommended value.</p><p>The output of VPA algorithm is the P99 consumption of cpu and memory. In order to reserve buffer for the application, it will multiply the magnification factor. You can configure the amplification factor in either of the following ways:</p><ol><li>Margin fraction: Recommended result = P99 usage * (1 + margin fraction), corresponding configuration: cpu-request-margin-fraction and me-request-margin-fraction</li><li>Target utilization: The recommended result is P99 amount/target utilization, and the corresponding configurations are cpu-target-utilization and mem-target-utilization</li></ol><p>When you have a target peak utilization target for the application, it is recommended to use the <strong>target utilization</strong> way to amplify the recommendation results.</p><h3 id=oom-protection>OOM Protection</h3><p>Craned runs a component, OOMRecorder, which records the events of the container OOM in the cluster. The resource recommendation reads the events of the OOM Recorder to obtain the memory usage at OOM time. We make sure the recommended memory is larger than the value when OOM happened.</p><h3 id=resource-specification>Resource Specification</h3><p>In Serverless Kubernetes, the cpu and memory specifications of the Pod are predefined. The resource recommendation can be rounded up according to the predefined resource specifications. For example, the recommended cpu value based on the historical usage is 0.125 core, and are rounded up to 0.25 core. You can also modify the specifications to meet the specifications requirements of your environment.</p><h3 id=prometheus-metric>Prometheus Metric</h3><p>Record recommended resource to Metric：crane_analysis_resource_recommendation</p><h2 id=how-to-verify-the-accuracy-of-recommendation-results>How to verify the accuracy of recommendation results</h2><p>You can use the following Prom-query to obtain the Workload Container resource usage. The recommended value is slightly higher than the historical maximum, considering the OOM and Pod specifications.</p><p>Taking Deployment Craned in crane-system as an example, you can use your container, namespace to replace it in following Prom-query.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>irate<span style=color:#f92672>(</span>container_cpu_usage_seconds_total<span style=color:#f92672>{</span>container!<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POD&#34;</span>,namespace<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;crane-system&#34;</span>,pod<span style=color:#f92672>=</span>~<span style=color:#e6db74>&#34;^craned.*</span>$<span style=color:#e6db74>&#34;</span>,container<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;craned&#34;</span><span style=color:#f92672>}[</span>3m<span style=color:#f92672>])</span>   <span style=color:#75715e># cpu usage</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>container_memory_working_set_bytes<span style=color:#f92672>{</span>container!<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POD&#34;</span>,namespace<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;crane-system&#34;</span>,pod<span style=color:#f92672>=</span>~<span style=color:#e6db74>&#34;^craned.*</span>$<span style=color:#e6db74>&#34;</span>,container<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;craned&#34;</span><span style=color:#f92672>}</span>  <span style=color:#75715e># memory usage</span>
</span></span></code></pre></div><h2 id=accepted-resources>Accepted Resources</h2><p>Support StatefulSet and Deployment by default，but all workloads that support <code>Scale SubResource</code> are supported.</p><h2 id=configuration>Configuration</h2><table><thead><tr><th>Configuration items</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>cpu-sample-interval</td><td>1m</td><td>Metric sampling interval for requesting CPU monitoring data</td></tr><tr><td>cpu-request-percentile</td><td>0.99</td><td>Target CPU Percentile that used for VPA</td></tr><tr><td>cpu-request-margin-fraction</td><td>0.15</td><td>CPU recommend value margin factor，0.15 means recommended value = recommended value * 1.15</td></tr><tr><td>cpu-target-utilization</td><td>1</td><td>CPU target utilization，0.8 means recommended value = recommended value / 0.8</td></tr><tr><td>cpu-model-history-length</td><td>168h</td><td>Historical length for CPU monitoring data</td></tr><tr><td>mem-sample-interval</td><td>1m</td><td>Metric sampling interval for requesting Memory monitoring data</td></tr><tr><td>mem-request-percentile</td><td>0.99</td><td>Target Memory Percentile that used for VPA</td></tr><tr><td>mem-request-margin-fraction</td><td>0.15</td><td>Memory recommend value margin factor，0.15 means recommended value = recommended value * 1.15</td></tr><tr><td>mem-target-utilization</td><td>1</td><td>Memory target utilization，0.8 means recommended value = recommended value / 0.8</td></tr><tr><td>mem-model-history-length</td><td>168h</td><td>Historical length for Memory monitoring data</td></tr><tr><td>specification</td><td>false</td><td>Enable for resource rpecification</td></tr><tr><td>specification-config</td><td>""</td><td>resource specifications configuration</td></tr><tr><td>oom-protection</td><td>true</td><td>Enable for OOM Prodection</td></tr><tr><td>oom-history-length</td><td>168h</td><td>OOM event history length, ignore too old events</td></tr><tr><td>oom-bump-ratio</td><td>1.2</td><td>OOM memory bump up ratio</td></tr><tr><td>cpu-histogram-bucket-size</td><td>0.1</td><td>The size of the balanced bucket is also equal to the minimum value recommended by the CPU</td></tr><tr><td>cpu-histogram-max-value</td><td>100</td><td>The maximum value of the balance bucket is also equal to the maximum value recommended by the CPU</td></tr><tr><td>mem-histogram-bucket-size</td><td>104857600</td><td>The size of the balanced bucket is also equal to the minimum value recommended by the MEM</td></tr><tr><td>mem-histogram-max-value</td><td>104857600000</td><td>The maximum value of the balance bucket is also equal to the maximum value recommended by the MEM</td></tr></tbody></table><p>How to update recommendation configuration please refer to：<a href=/docs/tutorials/recommendation/recommendation-framework><strong>Recommendation Framework</strong></a></p><h2 id=default-resource-specifications-configuration>Default resource specifications configuration</h2><table><thead><tr><th>CPU（Cores）</th><th>Memory（GBi）</th></tr></thead><tbody><tr><td>0.25</td><td>0.25</td></tr><tr><td>0.25</td><td>0.5</td></tr><tr><td>0.25</td><td>1</td></tr><tr><td>0.5</td><td>0.5</td></tr><tr><td>0.5</td><td>1</td></tr><tr><td>1</td><td>1</td></tr><tr><td>1</td><td>2</td></tr><tr><td>1</td><td>4</td></tr><tr><td>1</td><td>8</td></tr><tr><td>2</td><td>2</td></tr><tr><td>2</td><td>4</td></tr><tr><td>2</td><td>8</td></tr><tr><td>2</td><td>16</td></tr><tr><td>4</td><td>4</td></tr><tr><td>4</td><td>8</td></tr><tr><td>4</td><td>16</td></tr><tr><td>4</td><td>32</td></tr><tr><td>8</td><td>8</td></tr><tr><td>8</td><td>16</td></tr><tr><td>8</td><td>32</td></tr><tr><td>8</td><td>64</td></tr><tr><td>16</td><td>32</td></tr><tr><td>16</td><td>64</td></tr><tr><td>16</td><td>128</td></tr><tr><td>32</td><td>64</td></tr><tr><td>32</td><td>128</td></tr><tr><td>32</td><td>256</td></tr><tr><td>64</td><td>128</td></tr><tr><td>64</td><td>256</td></tr></tbody></table></div></main></div></div></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>